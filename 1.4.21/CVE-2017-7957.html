<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
 Copyright (C) 2005, 2006 Joe Walnes.
 Copyright (C) 2006, 2007, 2008, 2021 XStream committers.
 All rights reserved.
 
 The software in this package is published under the terms of the BSD
 style license a copy of which has been included with this distribution in
 the LICENSE.txt file.
 
 Created on 29. January 2005 by Joe Walnes
 -->
    <head>
        <title>XStream - CVE-2017-7957</title>
        <link rel="stylesheet" type="text/css" href="style.css"/>
        
    
  

        <!-- Google analytics -->
        <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
        </script>
        <script type="text/javascript">
          _uacct = "UA-110973-2";
          urchinTracker();
        </script>

    </head>
    <body>

        <div id="banner">
            <a href="index.html"><img id="logo" src="logo.gif" alt="XStream"/></a>
        </div>

        <div id="center" class="Content2Column">  <!-- Content3Column for index -->
            <div id="content">
                <h1 class="FirstChild">CVE-2017-7957</h1>

                

    <h2 id="vulnerability">Vulnerability</h2>
    
    <p>CVE-2017-7957: XStream can cause a Denial of Service when unmarshalling void.</p>
	
    <h2 id="affected_versions">Affected Versions</h2>
    
	<p>All versions until and including version 1.4.9 are affected, but <a href="#workarounds">workarounds</a> exist.</p>

    <h2 id="description">Description</h2>
    
    <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.
    XStream creates therefore new instances based on these type information.  The crash occurs if this information
    advises XStream to create an instance of the primitive type <em>void</em>.  This situation can only happen if an
    attacker was able to manipulate the incoming data, since such an instance does not exist and cannot be marshalled
    therefore in first place.</p>

    <h2 id="reproduction">Steps to Reproduce</h2>

	<p>The simplest way to demonstrate the problem is with this snippet:</p>
<div class="Source Java"><pre>XStream xstream = new XStream();
xstream.fromXML("&lt;void/&gt;");
</pre></div>

<p>If XStream is configured to read JSON, the equivalent line is:</p>
<div class="Source Java"><pre>xstream.fromXML("{'void':null}");
</pre></div>

<p>However, the problematic type information can be injected at any position in 
the provided stream, in XML just by adding a class attribute:</p>
<div class="Source Java"><pre>xstream.fromXML("&lt;string class='void'&gt;Hello, world!&lt;/string&gt;");
</pre></div>

    <h2 id="impact">Impact</h2>

	<p>The vulnerability may allow a remote attacker to cause a crash on the target system resulting in a denial of
	service only by manipulating the processed input stream.</p>

    <h2 id="workarounds">Workarounds</h2>
	<p>XStream contains since version 1.4.7 a <a href="security.html">security framework</a> to prevent an attack
	described in CVE-2013-7285.  If this framework is properly initialized, it can also be used to suppress the current
	vulnerability by setting:</p>
<div class="Source Java"><pre>xstream.denyTypes(new Class[]{ void.class, Void.class });
</pre></div>

	<p>Users of older XStream releases can register an own converter for the <em>void</em> type, that also protects
	against this attack:</p>
<div class="Source Java"><pre>xstream.registerConverter(new Converter() {
  public boolean canConvert(Class type) {
    return Void.class == type || void.class == type;
  }

  public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {
    throw new ConversionException("Type void cannot have an instance");
  }

  public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) {
    throw new ConversionException("Type void cannot have an instance");
  }
}, XStream.PRIORITY_VERY_HIGH);
</pre></div>

    <h2 id="credits">Credits</h2>
    
    <p>The vulnerability was discovered and reported by Huijun Chen and Xiaolong Zhu of Huawei Technologies Co., Ltd.</p>
    
  	

                <br/>

            </div>
        </div>

        <div class="SidePanel" id="left">
                    <div class="MenuGroup">
                        <h1>Software</h1>
                        <ul>
                                    <li><a href="index.html">About XStream</a></li>
                                    <li><a href="news.html">News</a></li>
                                    <li><a href="changes.html">Change History</a></li>
                                    <li><a href="security.html">Security Aspects</a></li>
                                    <li><a href="versioning.html">About Versioning</a></li>
                        </ul>
                    </div>
                    <div class="MenuGroup">
                        <h1>Evaluating XStream</h1>
                        <ul>
                                    <li><a href="tutorial.html">Two Minute Tutorial</a></li>
                                    <li><a href="license.html">License</a></li>
                                    <li><a href="download.html">Download</a></li>
                                    <li><a href="references.html">References</a></li>
                                    <li><a href="benchmarks.html">Benchmarks</a></li>
                                    <li><a href="https://www.openhub.net/p/xstream">Code Statistics</a></li>
                        </ul>
                    </div>
                    <div class="MenuGroup">
                        <h1>Using XStream</h1>
                        <ul>
                                    <li><a href="architecture.html">Architecture Overview</a></li>
                                    <li><a href="graphs.html">Object references</a></li>
                                    <li><a href="manual-tweaking-output.html">Tweaking the Output</a></li>
                                    <li><a href="converters.html">Converters</a></li>
                                    <li><a href="faq.html">Frequently Asked Questions</a></li>
                                    <li><a href="mailing-lists.html">Mailing Lists</a></li>
                                    <li><a href="issues.html">Reporting Issues</a></li>
                        </ul>
                    </div>
                    <div class="MenuGroup">
                        <h1>Javadoc</h1>
                        <ul>
                                    <li><a href="javadoc/index.html">XStream Core</a></li>
                                    <li><a href="hibernate-javadoc/index.html">Hibernate Extensions</a></li>
                                    <li><a href="jmh-javadoc/index.html">JMH Module</a></li>
                        </ul>
                    </div>
                    <div class="MenuGroup">
                        <h1>Tutorials</h1>
                        <ul>
                                    <li><a href="tutorial.html">Two Minute Tutorial</a></li>
                                    <li><a href="alias-tutorial.html">Alias Tutorial</a></li>
                                    <li><a href="annotations-tutorial.html">Annotations Tutorial</a></li>
                                    <li><a href="converter-tutorial.html">Converter Tutorial</a></li>
                                    <li><a href="objectstream.html">Object Streams Tutorial</a></li>
                                    <li><a href="persistence-tutorial.html">Persistence API Tutorial</a></li>
                                    <li><a href="json-tutorial.html">JSON Tutorial</a></li>
                                    <li><a href="http://www.studytrails.com/java/xml/xstream/xstream-introduction.jsp">StudyTrails</a></li>
                        </ul>
                    </div>
                    <div class="MenuGroup">
                        <h1>Developing XStream</h1>
                        <ul>
                                    <li><a href="how-to-contribute.html">How to Contribute</a></li>
                                    <li><a href="team.html">Development Team</a></li>
                                    <li><a href="repository.html">Source Repository</a></li>
                                    <li><a href="https://travis-ci.org/x-stream/xstream/branches">Continuous Integration</a></li>
                        </ul>
                    </div>
        </div>

  </body>
</html>
